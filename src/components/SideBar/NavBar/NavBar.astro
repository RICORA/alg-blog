---
import { twMerge } from "tailwind-merge"
import type { HTMLAttributes } from "astro/types"
import { IconLink } from "./IconLink"
import Links from "./Links.astro"
import { ToggleThemeButton } from "./ToggleThemeButton"
import { Icon } from "@/components/Elements/Icon"
import { SearchModal } from "./SearchModal"

type Props = HTMLAttributes<"aside">
const { class: className, ...props } = Astro.props
---

<script>
  // TODO: SolidJS or Reactで宣言的に実装する
  import { toggleTheme } from "@/lib/theme"
  document.querySelector("#toggleTheme")?.addEventListener("click", toggleTheme)
</script>

<aside
  class={twMerge(
    "flex flex-col gap-4 py-12 md:sticky md:top-0 md:h-dvh md:max-w-[25%] lg:max-w-[20%] xl:max-w-[15%]",
    className,
  )}
  data-pagefind-ignore="all"
  {...props}
>
  <a href="/" class="mx-2 h-fit w-fit">
    <Icon name="brand:ricora" alt="RICORA" class="h-32 w-32 rounded-full bg-bg-default p-2 shadow-md" />
  </a>
  <div class="mx-2 flex flex-col gap-2">
    <h1 class="text-xl font-bold">RICORA Programming Team</h1>
    <h2 class="gap-2 text-sm text-fg-muted">
      <span class="inline-block">東京理科大学<span> </span></span>
      <span class="inline-block">電子計算機研究会<span> </span></span>
      <span class="inline-block">プログラミング班</span>
    </h2>
  </div>
  <div class="mx-2 flex flex-row gap-2">
    <IconLink name="line-md:github-loop" label="GitHub" href="https://github.com/RICORA/" client:load />
    <IconLink name="line-md:twitter-x" label="X (旧Twitter)" href="https://twitter.com/ricora_alg/" client:load />
    <IconLink
      name="line-md:youtube"
      label="YouTube"
      href="https://www.youtube.com/channel/UC4qBY_aaTvTkQ3E0PY89T2A"
      client:load
    />
  </div>
  <Links />
  <SearchModal client:only="solid">
    <Icon slot="searchIcon" name="tabler:search" class="h-6 w-6" />
    <Icon slot="buttonIcon" name="tabler:search" class="h-6 w-6" />
  </SearchModal>
  <div class="mt-auto hidden p-2 md:flex">
    <ToggleThemeButton client:only="solid" />
  </div>
</aside>
