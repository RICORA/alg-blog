---
import { LinkCard } from "../LinkCard"
import "./oEmbed.css"
import type { OEmbed } from "./oEmbedSchema"
import { OEmbedVideo } from "./OEmbedVideo"
import { OEmbedRich } from "./OEmbedRich"
import { OEmbedPhoto } from "./OEmbedPhoto"

const getProps = (props: Props) => {
  props.oEmbed = JSON.parse(props.oEmbed as unknown as string) // props.oEmbed is a stringified JSON
  return props
}

type Props = {
  oEmbed: OEmbed
  href: string
}

const { oEmbed, href } = getProps(Astro.props)
console.log(oEmbed)
---

{
  oEmbed.type === "photo" ? (
    <OEmbedPhoto {oEmbed} {href} />
  ) : oEmbed.type === "video" ? (
    <OEmbedVideo {oEmbed} {href} />
  ) : oEmbed.type === "rich" ? (
    <OEmbedRich {oEmbed} {href} />
  ) : (
    <LinkCard href={href} />
  )
}
